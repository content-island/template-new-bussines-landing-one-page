---
import type { LanguageCode } from '@content-island/api-client';
import { LANGUAGES } from '#core/constans';
import { generateLanguagePaths } from '#core/helpers';
import Layout from '#layouts/Layout.astro';
import PrivacyPolicyComponent from '#pods/privacy-policy/PrivacyPolicy.astro';
import { getPrivacyPolicyMeta, getPrivacyPolicy } from '#pods/privacy-policy';

interface Props {
  params: {
    lang: LanguageCode;
    privacyPolicy: string;
  };
}

export const getStaticPaths = async () => {
  const privacyPolicies = await Promise.all(LANGUAGES.map(getPrivacyPolicy));

  return privacyPolicies.map(({ language, slug }) => ({
    params: { lang: language, privacyPolicy: slug },
  }));
};

const { lang } = Astro.params as Props['params'];
const { title, description } = await getPrivacyPolicyMeta(lang);

const privacyPolicies = await Promise.all(LANGUAGES.map(getPrivacyPolicy));
const languagePaths = generateLanguagePaths(privacyPolicies);
---

<Layout lang={lang} title={title} description={description} languagePaths={languagePaths}>
  <PrivacyPolicyComponent lang={lang} />
</Layout>
